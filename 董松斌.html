<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>

<body>
    <script>
        var canvas = document.createElement('canvas');
        canvas.width = 500;
        canvas.height = 500;
        canvas.style.border = '1px solid pink';
        document.body.appendChild(canvas);
        var ctx = canvas.getContext('2d');

        var pi = Math.PI / 180;
        ctx.save()
        ctx.fillStyle = 'white';
        ctx.beginPath();
        ctx.moveTo(250, 250);
        ctx.arc(250, 250, 120, 0, pi * 360, true);
        ctx.fill();
        ctx.restore();

        ctx.save();
        ctx.fillStyle = 'yellow';
        ctx.beginPath();
        ctx.moveTo(250, 250);
        ctx.arc(250, 250, 120, 0, -(pi * 10), false);
        ctx.fill();
        ctx.restore();


        ctx.lineWidth = '3';

        ctx.beginPath();
        ctx.moveTo(250, 133);
        ctx.lineTo(250, 150);
        ctx.stroke();

        ctx.lineWidth = '3';
        ctx.beginPath();
        ctx.moveTo(260, 133);
        ctx.lineTo(260, 150);
        ctx.stroke();

        ctx.lineWidth = '3';
        ctx.beginPath();
        ctx.moveTo(270, 133);
        ctx.lineTo(270, 150);
        ctx.stroke();

        ctx.lineWidth = '3';
        ctx.beginPath();
        ctx.moveTo(280, 133);
        ctx.lineTo(280, 150);
        ctx.stroke();

        ctx.lineWidth = '3';
        ctx.beginPath();
        ctx.moveTo(240, 133);
        ctx.lineTo(240, 150);
        ctx.stroke();

        ctx.lineWidth = '3';
        ctx.beginPath();
        ctx.moveTo(230, 133);
        ctx.lineTo(230, 150);
        ctx.stroke();

        ctx.lineWidth = '3';
        ctx.beginPath();
        ctx.moveTo(220, 133);
        ctx.lineTo(220, 150);
        ctx.stroke();

        ctx.save();
        ctx.fillStyle = 'white';
        ctx.beginPath();
        ctx.arc(295, 195, 10, 0, pi * 360);
        ctx.fill();
        ctx.restore();

        ctx.save();
        ctx.fillStyle = 'black';
        ctx.beginPath();
        ctx.arc(298, 198, 5, 0, pi * 360);
        ctx.fill();
        ctx.restore();







        var canvas1 = document.createElement('canvas');
        canvas1.width = 500;
        canvas1.height = 500;
        canvas1.style.border = '1px solid green';
        document.body.appendChild(canvas1);
        var ctx = canvas1.getContext('2d');


        var pi = Math.PI / 180;
        ctx.save();
        ctx.fillStyle = 'pink';
        ctx.beginPath();
        ctx.arc(250, 250, 150, 0, pi * 360);
        ctx.fill();
        ctx.restore();



        var data = [
            { value: 335, name: '直接访问', color: "rgb(213, 58, 53)" },
            { value: 310, name: '邮件营销', color: "rgb(51, 75, 92)" },
            { value: 234, name: '联盟广告', color: "rgb(106, 176, 184)" },
            { value: 135, name: '视频广告', color: "rgb(233, 143, 111)" },
            { value: 1548, name: '搜索引擎', color: "rgb(145, 199, 174)" }
        ]


        for(i in data){
            ctx.save();
            ctx.fillStyle = data[i].color;
            ctx.beginPath();
            ctx.fillRect(15,(i+1)*3,16,10);
            ctx.fillText(data[i].name,35,(i+4)*3);
            ctx.fill();
            ctx.restore();
        }




        var arr = [];
        // var colorarr =  '';
        for (i in data) {
            arr.push(data[i].value);
            // colorarr.push(data[i].color);
        }
        var sum = arr.reduce(function (a, b) {
            return a + b;
        })
        // console.log(data[i].color);

        var deg = arr.map(function (item) {
            return (item / sum * 360);
        })
        console.log(deg);


        var startdeg = 0;
        ctx.save();
        for (i = 0; i < deg.length; i++) {
            ctx.beginPath();
            var enddeg = deg[i];
            ctx.fillStyle = data[i].color;
            ctx.moveTo(250, 250);
            // ctx.lineTo(250,130);

            ctx.arc(250, 250, 150, startdeg * pi, -((startdeg + enddeg) * pi));
            ctx.closePath();
            ctx.fill();
            // ctx.stroke();
            startdeg += enddeg;
            ctx.restore();
        }

        ctx.save();
        ctx.fillStyle = 'white';
        ctx.beginPath();
        ctx.arc(250, 250, 110, 0, pi * 360);
        ctx.fill();
        ctx.restore();
    </script>
</body>

</html>